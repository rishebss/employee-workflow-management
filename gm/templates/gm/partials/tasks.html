<div class="table-container">

    <div style="padding: 1.25rem 1.5rem; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; gap: 1rem; flex-wrap: wrap;">

        <div style="display: flex; align-items: baseline; gap: 0.75rem;">

            <h3 style="margin: 0; font-size: 1.25rem; font-weight: 700; letter-spacing: 0.2px;">All Tasks</h3>

            <span style="color: var(--text-secondary); font-size: 0.9rem;">Manage and track team tasks</span>

        </div>

        <div style="display:flex; gap: 0.5rem; align-items: center; flex-wrap: wrap;">

            <button class="btn btn-primary" style="background: var(--accent); color: var(--bg-primary); border: none; border-radius: 8px; padding: 0.5rem 1rem; font-size: 0.9rem; font-weight: 500; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 0.5rem;">

                <i class="fas fa-tasks"></i>

                Total: {{ tasks|length }}

            </button>

            {% if overdue_count > 0 %}

            <button class="btn btn-danger" style="background: #ef4444; color: white; border: none; border-radius: 8px; padding: 0.5rem 1rem; font-size: 0.9rem; font-weight: 500; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 0.5rem;">

                <i class="fas fa-exclamation-triangle"></i>

                Overdue: {{ overdue_count }}

            </button>

            {% endif %}

            <select id="taskFilter" onchange="filterTasks()" style="background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 8px; padding: 0.5rem; font-size: 0.9rem;">

                <option value="">All Tasks</option>

                <option value="overdue">Overdue Only</option>

                <option value="pending">Pending</option>

                <option value="completed">Completed</option>

                <option value="high">High Priority</option>

            </select>

            <button class="btn btn-primary" onclick="openCreateTaskModal()" style="background: var(--accent); color: var(--bg-primary); border: none; border-radius: 8px; padding: 0.5rem 1rem; font-size: 0.9rem; font-weight: 500; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-plus"></i>
                Create Task
            </button>

        </div>

    </div>



    <!-- Task Cards Grid -->

    <div class="task-cards">

        {% for task in tasks %}

        <div class="task-card {% if task.is_overdue %}overdue{% endif %}">

            <div class="task-header">

                <div class="task-title-row">

                    <h4 class="task-title">{{ task.title }}</h4>

                </div>

                <div class="task-actions">

                    <button class="action-btn view-btn" onclick="openTaskDetails({{ task.id }})" title="View Details">

                        <i class="fas fa-eye"></i>

                    </button>

                    <button class="action-btn edit-btn" onclick="editTask({{ task.id }})" title="Edit Task">

                        <i class="fas fa-edit"></i>

                    </button>

                    <button class="action-btn delete-btn" onclick="deleteTask({{ task.id }})" title="Delete Task">

                        <i class="fas fa-trash"></i>

                    </button>

                </div>

            </div>

            

            <!-- Hidden task description for modal use -->
            <div class="task-description" style="display: none;">

                <p>{{ task.description }}</p>

            </div>

            

            <div class="task-meta">

                <div class="meta-item">

                    <span class="meta-label">Assigned by:</span>

                    <span class="meta-value">{{ task.assigned_by.get_full_name }}</span>

                </div>

                <div class="meta-item">

                    <span class="meta-label">Assigned to:</span>

                    <span class="meta-value">{{ task.assigned_to.get_full_name }}</span>

                    <span class="meta-role">{{ task.assigned_to.get_role_display }}</span>

                </div>

                <div class="meta-item">

                    <span class="meta-label">Created:</span>

                    <span class="meta-value">{{ task.created_at|date:"M d, Y" }}</span>

                </div>

                {% if task.completed_at %}

                <div class="meta-item">

                    <span class="meta-label">Completed:</span>

                    <span class="meta-value">{{ task.completed_at|date:"M d, Y g:i A" }}</span>

                </div>

                {% endif %}

            </div>

            

            <div class="task-footer">

                <div class="task-badges">

                    <span class="priority-badge priority-{{ task.priority|lower }}">{{ task.get_priority_display }}</span>

                    <span class="status-badge status-{{ task.status|lower }}">{{ task.get_status_display }}</span>

                </div>

                <div class="task-deadline {% if task.is_overdue %}overdue{% endif %}">

                    <i class="fas fa-clock"></i>

                    {{ task.deadline|date:"M d, Y g:i A" }}

                    {% if not task.is_overdue and task.days_until_deadline >= 0 %}

                        <span class="days-remaining">({{ task.days_until_deadline }}d left)</span>

                    {% endif %}

                </div>

            </div>

        </div>

        {% empty %}

        <div class="empty-state">

            <div class="empty-icon">

                <i class="fas fa-tasks"></i>

            </div>

            <h3>No tasks found</h3>

            <p>Create your first task to get started with task management.</p>

            <button class="btn btn-primary" onclick="openCreateTaskModal()">

                <i class="fas fa-plus"></i>

                Create Task

            </button>

        </div>

        {% endfor %}

    </div>



    <!-- Table View (Hidden by default, can be toggled) -->

    <div class="table-scroll-vert" style="margin-top: 1rem; display: none;" id="tableView">

        <table class="bc-table bc-table-striped">

            <thead>

                <tr>

                    <th style="width: 25%;">Title</th>

                    <th style="width: 15%;">Assigned By</th>

                    <th style="width: 15%;">Assigned To</th>

                    <th style="width: 12%;">Priority</th>

                    <th style="width: 12%;">Status</th>

                    <th style="width: 15%;">Deadline</th>

                    <th style="width: 6%;">Actions</th>

                </tr>

            </thead>

            <tbody>

                {% for task in tasks %}

                <tr>

                    <td>

                        <div class="task-title-cell">

                            <strong>{{ task.title }}</strong>

                            {% if task.is_overdue %}

                                <span class="overdue-badge">

                                    <i class="fas fa-exclamation-triangle"></i>

                                    OVERDUE ({{ task.overdue_days }}d)

                                </span>

                            {% endif %}

                        </div>

                    </td>

                    <td>{{ task.assigned_by.get_full_name }}</td>

                    <td>

                        {{ task.assigned_to.get_full_name }}

                        <br>

                        <small class="role-small">{{ task.assigned_to.get_role_display }}</small>

                    </td>

                    <td>

                        <span class="priority-badge priority-{{ task.priority|lower }}">{{ task.get_priority_display }}</span>

                    </td>

                    <td>

                        <span class="status-badge status-{{ task.status|lower }}">{{ task.get_status_display }}</span>

                    </td>

                    <td class="{% if task.is_overdue %}overdue{% endif %}">

                        {{ task.deadline|date:"M d, Y g:i A" }}

                        {% if task.is_overdue %}

                            <br><small class="overdue-text">{{ task.overdue_days }} days overdue</small>

                        {% elif task.days_until_deadline >= 0 %}

                            <br><small class="days-left-text">{{ task.days_until_deadline }} days left</small>

                        {% endif %}

                    </td>

                    <td>

                        <button class="action-btn" onclick="deleteTask({{ task.id }})" title="Delete Task">

                            <i class="fas fa-trash"></i>

                        </button>

                    </td>

                </tr>

                {% endfor %}

            </tbody>

        </table>

    </div>

</div>


<!-- Create Task Modal -->

<div id="createTaskModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; align-items: center; justify-content: center; backdrop-filter: blur(10px);">

    <div class="modal-content" style="background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 16px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto;">

        <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; border-bottom: 1px solid var(--border-color);">

            <h2 class="modal-title" style="font-size: 1.5rem; font-weight: 600; margin: 0;">Create New Task</h2>

            <button class="modal-close" onclick="closeCreateTaskModal()" style="background: transparent; border: none; color: var(--text-secondary); font-size: 1.5rem; cursor: pointer; padding: 0.5rem; border-radius: 8px;">

                <i class="fas fa-times"></i>

            </button>

        </div>

        <form id="createTaskForm" onsubmit="createTask(event)">

            <div class="modal-body" style="padding: 1.5rem;">

                <div class="form-group" style="margin-bottom: 1.5rem;">

                    <label class="form-label" for="taskTitle" style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-primary);">Title *</label>

                    <input type="text" id="taskTitle" class="form-control" required placeholder="Enter task title" style="width: 100%; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 0.75rem; color: var(--text-primary); font-size: 1rem; transition: border 0.2s ease;">

                </div>

                

                <div class="form-group" style="margin-bottom: 1.5rem;">

                    <label class="form-label" for="taskDescription" style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-primary);">Description *</label>

                    <textarea id="taskDescription" class="form-control form-textarea" required placeholder="Enter task description" style="width: 100%; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 0.75rem; color: var(--text-primary); font-size: 1rem; resize: vertical; min-height: 100px;"></textarea>

                </div>

                

                <div class="form-group" style="margin-bottom: 1.5rem;">

                    <label class="form-label" for="taskAssignedTo" style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-primary);">Assign To *</label>

                    <select id="taskAssignedTo" class="form-control" required style="width: 100%; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 0.75rem; color: var(--text-primary); font-size: 1rem;">

                        <option value="">Select team member</option>

                        {% for member in staff_members %}

                            <option value="{{ member.id }}">

                                {{ member.get_full_name }} - {{ member.get_role_display }}

                            </option>

                        {% endfor %}

                    </select>

                </div>

                

                <div class="form-group" style="margin-bottom: 1.5rem;">

                    <label class="form-label" for="taskPriority" style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-primary);">Priority</label>

                    <select id="taskPriority" class="form-control" style="width: 100%; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 0.75rem; color: var(--text-primary); font-size: 1rem;">

                        <option value="LOW">Low</option>

                        <option value="MEDIUM" selected>Medium</option>

                        <option value="HIGH">High</option>

                        <option value="URGENT">Urgent</option>

                    </select>

                </div>

                

                <div class="form-group" style="margin-bottom: 1.5rem;">

                    <label class="form-label" for="taskDeadline" style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-primary);">Deadline *</label>

                    <input type="datetime-local" id="taskDeadline" class="form-control" required style="width: 100%; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 0.75rem; color: var(--text-primary); font-size: 1rem;">

                </div>

            </div>

            <div class="modal-footer" style="display: flex; justify-content: flex-end; gap: 1rem; padding: 1.5rem; border-top: 1px solid var(--border-color);">

                <button type="button" class="btn btn-secondary" onclick="closeCreateTaskModal()" style="padding: 0.75rem 1.5rem; border-radius: 8px; font-size: 0.9rem; font-weight: 500; border: none; cursor: pointer; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-color);">Cancel</button>

                <button type="submit" class="btn btn-primary" style="padding: 0.75rem 1.5rem; border-radius: 8px; font-size: 0.9rem; font-weight: 500; border: none; cursor: pointer; background: var(--accent); color: var(--bg-primary);">Create Task</button>

            </div>

        </form>

    </div>

</div>



<!-- Task Details Modal -->

<div id="taskDetailsModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; align-items: center; justify-content: center; backdrop-filter: blur(10px);">

    <div class="modal-content" style="background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 16px; width: 90%; max-width: 700px; max-height: 90vh; overflow-y: auto;">

        <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; border-bottom: 1px solid var(--border-color);">

            <h2 class="modal-title" style="font-size: 1.5rem; font-weight: 600; margin: 0;">Task Details</h2>

            <button class="modal-close" onclick="closeTaskDetails()" style="background: transparent; border: none; color: var(--text-secondary); font-size: 1.5rem; cursor: pointer; padding: 0.5rem; border-radius: 8px;">

                <i class="fas fa-times"></i>

            </button>

        </div>

        <div class="modal-body" style="padding: 1.5rem;">

            <div id="taskDetailsContent">

                <!-- Task details will be loaded here -->

            </div>

        </div>

    </div>

</div>



<script>

// Get CSRF token helper
function getCookie(name) {
    const value = `; ${document.cookie}`;
    const parts = value.split(`; ${name}=`);
    if (parts.length === 2) return parts.pop().split(';').shift();
}

// Task filtering functionality
function filterTasks() {
    const filter = document.getElementById('taskFilter').value;
    const taskCards = document.querySelectorAll('.task-card');
    
    taskCards.forEach(card => {
        let show = true;
        
        if (filter === 'overdue') {
            show = card.classList.contains('overdue');
        } else if (filter === 'pending') {
            const statusBadge = card.querySelector('.status-badge');
            show = statusBadge && statusBadge.textContent.trim() === 'Pending';
        } else if (filter === 'completed') {
            const statusBadge = card.querySelector('.status-badge');
            show = statusBadge && statusBadge.textContent.trim() === 'Completed';
        } else if (filter === 'high') {
            const priorityBadge = card.querySelector('.priority-badge');
            show = priorityBadge && priorityBadge.textContent.trim() === 'High';
        }
        
        card.style.display = show ? 'flex' : 'none';
    });
    
    // Update visible count
    const visibleCards = document.querySelectorAll('.task-card[style*="flex"], .task-card:not([style*="none"])');
    const totalCards = document.querySelectorAll('.task-card').length;
    
    // Update the total count display
    const totalButton = document.querySelector('.btn-primary');
    if (totalButton && filter) {
        totalButton.innerHTML = `<i class="fas fa-tasks"></i> Showing: ${visibleCards.length} of ${totalCards}`;
    } else if (totalButton) {
        totalButton.innerHTML = `<i class="fas fa-tasks"></i> Total: ${totalCards}`;
    }
}

// Modal Functions
function openCreateTaskModal() {

    document.getElementById('createTaskModal').style.display = 'flex';

    // Set min datetime to current time

    const now = new Date();

    now.setMinutes(now.getMinutes() - now.getTimezoneOffset());

    document.getElementById('taskDeadline').min = now.toISOString().slice(0, 16);

}



function closeCreateTaskModal() {

    document.getElementById('createTaskModal').style.display = 'none';

    document.getElementById('createTaskForm').reset();

    

    // Reset modal title and button

    document.querySelector('#createTaskModal .modal-title').textContent = 'Create New Task';

    document.querySelector('#createTaskModal button[type="submit"]').innerHTML = '<i class="fas fa-plus mr-1"></i> Create Task';

    

    // Remove task ID from form

    delete document.getElementById('createTaskForm').dataset.taskId;

}



function openTaskDetails(taskId) {

    // Find the task data from the current page

    const taskCards = document.querySelectorAll('.task-card');

    let taskData = null;

    

    // Extract task data from the DOM (we'll need to pass this data from Django)

    // For now, let's create a simple implementation

    const modal = document.getElementById('taskDetailsModal');

    const content = document.getElementById('taskDetailsContent');

    

    // Show loading state

    content.innerHTML = '<div style="text-align: center; padding: 2rem;"><i class="fas fa-spinner fa-spin"></i> Loading task details...</div>';

    modal.style.display = 'flex';

    

    // In a real implementation, you would fetch task details via AJAX

    // For now, let's create a mock implementation

    setTimeout(() => {

        loadTaskDetails(taskId);

    }, 500);

}



function loadTaskDetails(taskId) {

    // This would typically be an AJAX call to get task details

    // For now, we'll create a mock implementation

    const content = document.getElementById('taskDetailsContent');

    

    // Find the task card to extract data

    const taskCard = document.querySelector(`.view-btn[onclick*="${taskId}"]`)?.closest('.task-card');

    if (!taskCard) return;

    

    const title = taskCard.querySelector('.task-title').textContent;

    // Get description from the original task data (we'll need to pass this from Django)

    const description = taskCard.querySelector('.task-description p')?.textContent || 'No description available.';

    const metaItems = taskCard.querySelectorAll('.meta-item');

    const assignedBy = metaItems[0]?.querySelector('.meta-value')?.textContent || 'Unknown';

    const assignedTo = metaItems[1]?.querySelector('.meta-value')?.textContent || 'Unknown';

    const assignedRole = metaItems[1]?.querySelector('.meta-role')?.textContent || '';

    const priority = taskCard.querySelector('.priority-badge')?.textContent || 'Medium';

    const status = taskCard.querySelector('.status-badge')?.textContent || 'Pending';

    const deadline = taskCard.querySelector('.task-deadline')?.textContent?.trim() || 'No deadline';

    const isOverdue = taskCard.classList.contains('overdue');

    

    content.innerHTML = `

        <div class="task-details">

            <div class="task-details-header">

                <h3 class="task-details-title">${title}</h3>

                ${isOverdue ? '<span class="overdue-badge">OVERDUE</span>' : ''}

            </div>

            

            <div class="task-details-section">

                <h4 class="section-title">Description</h4>

                <p class="task-details-description">${description}</p>

            </div>

            

            <div class="task-details-grid">

                <div class="detail-item">

                    <span class="detail-label">Priority</span>

                    <span class="priority-badge priority-${priority.toLowerCase()}">${priority}</span>

                </div>

                

                <div class="detail-item">

                    <span class="detail-label">Status</span>

                    <span class="status-badge status-${status.toLowerCase().replace(' ', '_')}">${status}</span>

                </div>

                

                <div class="detail-item">

                    <span class="detail-label">Assigned By</span>

                    <span class="detail-value">${assignedBy}</span>

                </div>

                

                <div class="detail-item">

                    <span class="detail-label">Assigned To</span>

                    <span class="detail-value">${assignedTo}</span>

                    ${assignedRole ? `<span class="detail-role">${assignedRole}</span>` : ''}

                </div>

                

                <div class="detail-item">

                    <span class="detail-label">Deadline</span>

                    <span class="detail-value ${isOverdue ? 'overdue' : ''}">${deadline}</span>

                </div>

                

                <div class="detail-item">

                    <span class="detail-label">Task ID</span>

                    <span class="detail-value">#${taskId}</span>

                </div>

            </div>

            

            <div class="task-details-actions">

                <button class="btn btn-secondary" onclick="closeTaskDetails()">Close</button>

                <button class="btn btn-primary" onclick="editTaskFromDetails(${taskId})">

                    <i class="fas fa-edit"></i>

                    Edit Task

                </button>

                <button class="btn btn-danger" onclick="deleteTaskFromDetails(${taskId})">

                    <i class="fas fa-trash"></i>

                    Delete Task

                </button>

            </div>

        </div>

    `;

}



function closeTaskDetails() {

    document.getElementById('taskDetailsModal').style.display = 'none';

}



function editTaskFromDetails(taskId) {

    closeTaskDetails();

    editTask(taskId);

}



function deleteTaskFromDetails(taskId) {

    if (confirm('Are you sure you want to delete this task? This action cannot be undone.')) {

        deleteTask(taskId);

        closeTaskDetails();

    }

}



function createTask(event) {

    event.preventDefault();

    

    const form = document.getElementById('createTaskForm');

    const taskId = form.dataset.taskId;

    const isEdit = !!taskId;

    

    const formData = {

        title: document.getElementById('taskTitle').value,

        description: document.getElementById('taskDescription').value,

        assigned_to: document.getElementById('taskAssignedTo').value,

        priority: document.getElementById('taskPriority').value,

        deadline: document.getElementById('taskDeadline').value

    };

    

    const url = isEdit ? `/gm/tasks/${taskId}/update/` : '{% url "gm:create_task" %}';

    const method = isEdit ? 'PUT' : 'POST';

    

    axios({
        method: method,
        url: url,
        data: formData,
        headers: {
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': getCookie('csrftoken')
        }
    })

    .then(response => {

        if (response.data.status === 'success') {

            showToast(isEdit ? 'Task updated successfully!' : 'Task created successfully!', 'success');

            closeCreateTaskModal();

            // Reload the tasks tab

            loadTabContent('tasks');

        }

    })

    .catch(error => {

        console.error(`Error ${isEdit ? 'updating' : 'creating'} task:`, error);

        showToast(`Error ${isEdit ? 'updating' : 'creating'} task. Please try again.`, 'error');

    });

}



function editTask(taskId) {

    // Find the task card to extract data

    const taskCard = document.querySelector(`.edit-btn[onclick*="${taskId}"]`)?.closest('.task-card');

    if (!taskCard) return;

    

    // Extract task data from the DOM

    const title = taskCard.querySelector('.task-title').textContent;

    const description = taskCard.querySelector('.task-description p').textContent;

    const priority = taskCard.querySelector('.priority-badge').textContent.trim();

    const status = taskCard.querySelector('.status-badge').textContent.trim();

    

    // Open create modal with pre-filled data

    openCreateTaskModal();

    

    // Pre-fill the form

    document.getElementById('taskTitle').value = title;

    document.getElementById('taskDescription').value = description;

    document.getElementById('taskPriority').value = priority.toUpperCase();

    

    // Change modal title and submit button

    document.querySelector('#createTaskModal .modal-title').textContent = 'Edit Task';

    document.querySelector('#createTaskModal button[type="submit"]').innerHTML = '<i class="fas fa-save mr-1"></i> Update Task';

    

    // Store task ID for update

    document.getElementById('createTaskForm').dataset.taskId = taskId;

}



function deleteTask(taskId) {

    if (confirm('Are you sure you want to delete this task? This action cannot be undone.')) {

        axios.post(`/gm/tasks/${taskId}/delete/`)

            .then(response => {

                if (response.data.status === 'success') {

                    showToast('Task deleted successfully!', 'success');

                    // Reload the tasks tab

                    loadTabContent('tasks');

                }

            })

            .catch(error => {

                console.error('Error deleting task:', error);

                showToast('Error deleting task. Please try again.', 'error');

            });

    }

}



function showToast(message, type = 'success') {

    const toast = document.createElement('div');

    toast.textContent = message;

    toast.style.cssText = `

        position: fixed;

        top: 20px;

        right: 20px;

        padding: 1rem 1.5rem;

        border-radius: 12px;

        color: white;

        font-weight: 500;

        z-index: 10001;

        animation: slideIn 0.3s ease;

        background: ${type === 'success' ? '#10b981' : '#ef4444'};

        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);

    `;

    

    document.body.appendChild(toast);

    

    setTimeout(() => {

        toast.style.animation = 'slideOut 0.3s ease forwards';

        setTimeout(() => toast.remove(), 300);

    }, 3000);

}



// Close modal when clicking outside
const createTaskModal = document.getElementById('createTaskModal');
if (createTaskModal) {
    createTaskModal.addEventListener('click', function(e) {
        if (e.target === this) {
            closeCreateTaskModal();
        }
    });
}

// Close task details modal when clicking outside
const taskDetailsModal = document.getElementById('taskDetailsModal');
if (taskDetailsModal) {
    taskDetailsModal.addEventListener('click', function(e) {
    if (e.target === this) {

            closeTaskDetails();
    }

});

}


// Close modal with escape key

document.addEventListener('keydown', function(e) {

    if (e.key === 'Escape') {

        closeCreateTaskModal();

        closeTaskDetails();

        closeTaskSidebar();
    }
});

// Initialize when the script loads
document.addEventListener('DOMContentLoaded', function() {
    // Add CSS animations if not already present
    if (!document.querySelector('style[data-toast-animations]')) {
        const style = document.createElement('style');
        style.setAttribute('data-toast-animations', '');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    }
});
</script>



<style>

/* Task Cards Layout */

.task-cards {

  display: grid;

  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));

  gap: 1rem;

  padding: 1rem 1.25rem;

  overflow-x: hidden;

  width: 100%;

  box-sizing: border-box;

}



.task-card {

  background: var(--card-bg);

  border: 1px solid var(--border-color);

  border-radius: 12px;

  padding: 1.25rem;

  transition: all 0.2s ease;

  position: relative;

  width: 100%;

  box-sizing: border-box;

  overflow: hidden;

  display: flex;

  flex-direction: column;

  gap: 1rem;

}



.task-card:hover {

  border-color: var(--border-hover);

  transform: translateY(-2px);

  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);

}



.task-card.overdue {

  border-left: 4px solid #ef4444;

  background: rgba(239, 68, 68, 0.02);

}



.task-header {

  display: flex;

  justify-content: space-between;

  align-items: flex-start;

  margin-bottom: 0;

}



.task-title-row {

  display: flex;

  align-items: center;

  gap: 0.5rem;

  flex: 1;

}



.task-title {

  font-size: 1.1rem;

  font-weight: 600;

  margin: 0;

  color: var(--text-primary);

  line-height: 1.3;

}



.overdue-badge {

  background: rgba(239, 68, 68, 0.2);

  color: #fca5a5;

  padding: 0.2rem 0.5rem;

  border-radius: 4px;

  font-size: 0.7rem;

  font-weight: 600;

  white-space: nowrap;

  display: flex;

  align-items: center;

  gap: 0.25rem;

}



.task-description {

  margin-bottom: 0.75rem;

}



.task-description p {

  color: var(--text-secondary);

  font-size: 0.9rem;

  line-height: 1.4;

  margin: 0;

}



.days-remaining {

  color: var(--text-tertiary);

  font-size: 0.75rem;

  font-weight: 500;

}



.overdue-text {

  color: #ef4444;

  font-weight: 600;

}



.days-left-text {

  color: var(--text-tertiary);

  font-weight: 500;

}



.edit-btn:hover {

  background: rgba(59, 130, 246, 0.2);

  color: #93c5fd;

}



.task-actions {

  display: flex;

  gap: 0.5rem;

}



.action-btn {

  background: transparent;

  border: none;

  color: var(--text-secondary);

  cursor: pointer;

  padding: 0.5rem;

  border-radius: 6px;

  transition: all 0.2s ease;

  display: flex;

  align-items: center;

  justify-content: center;

  font-size: 0.9rem;

}



.action-btn:hover {

  background: var(--bg-secondary);

  color: var(--text-primary);

  transform: scale(1.05);

}



.view-btn:hover {

  background: rgba(59, 130, 246, 0.2);

  color: #93c5fd;

}



.delete-btn:hover {

  background: rgba(239, 68, 68, 0.2);

  color: #fca5a5;

}



.task-meta {

  display: flex;

  flex-direction: column;

  gap: 0.5rem;

  margin-bottom: 0;

}



.meta-item {

  display: flex;

  align-items: center;

  gap: 0.5rem;

  flex-wrap: wrap;

}



.meta-label {

  font-size: 0.8rem;

  color: var(--text-tertiary);

  font-weight: 500;

  min-width: 80px;

}



.meta-value {

  font-weight: 500;

  color: var(--text-primary);

}



.meta-role {

  font-size: 0.75rem;

  color: var(--text-secondary);

  background: rgba(255, 255, 255, 0.05);

  padding: 0.2rem 0.4rem;

  border-radius: 4px;

}



.task-footer {

  display: flex;

  justify-content: space-between;

  align-items: center;

  flex-wrap: wrap;

  gap: 0.75rem;

  width: 100%;

  box-sizing: border-box;

}



.task-badges {

  display: flex;

  gap: 0.5rem;

  flex-wrap: wrap;

}



.priority-badge, .status-badge {

  padding: 0.25rem 0.75rem;

  border-radius: 50px;

  font-size: 0.75rem;

  font-weight: 600;

  border: 1px solid transparent;

}



.priority-low { background: rgba(16, 185, 129, 0.2); color: #86efac; }

.priority-medium { background: rgba(245, 158, 11, 0.2); color: #fcd34d; }

.priority-high { background: rgba(239, 68, 68, 0.2); color: #fca5a5; }

.priority-urgent { background: rgba(239, 68, 68, 0.4); color: #fca5a5; border-color: rgba(239, 68, 68, 0.6); }



.status-pending { background: rgba(245, 158, 11, 0.2); color: #fcd34d; }

.status-in_progress { background: rgba(59, 130, 246, 0.2); color: #93c5fd; }

.status-completed { background: rgba(16, 185, 129, 0.2); color: #86efac; }

.status-cancelled { background: rgba(107, 114, 128, 0.2); color: #9ca3af; }



.task-deadline {

  display: flex;

  align-items: center;

  gap: 0.25rem;

  font-size: 0.8rem;

  color: var(--text-secondary);

  font-weight: 500;

}



.task-deadline.overdue {

  color: #ef4444;

  font-weight: 600;

}



.task-deadline i {

  font-size: 0.7rem;

}



/* Empty State */

.empty-state {

  grid-column: 1 / -1;

  text-align: center;

  padding: 3rem 2rem;

  color: var(--text-secondary);

}



.empty-icon {

  font-size: 3rem;

  margin-bottom: 1rem;

  opacity: 0.5;

}



.empty-state h3 {

  font-size: 1.25rem;

  font-weight: 600;

  margin-bottom: 0.5rem;

  color: var(--text-primary);

}



.empty-state p {

  margin-bottom: 1.5rem;

  max-width: 400px;

  margin-left: auto;

  margin-right: auto;

}



/* Table View Styles */

.task-title-cell {

  display: flex;

  flex-direction: column;

  gap: 0.25rem;

}



.task-desc-small {

  color: var(--text-secondary);

  font-size: 0.8rem;

}



.role-small {

  color: var(--text-secondary);

  font-size: 0.75rem;

}



/* Task Details Modal Styles */

.task-details {

  display: flex;

  flex-direction: column;

  gap: 1.5rem;

}



.task-details-header {

  display: flex;

  align-items: center;

  gap: 1rem;

  padding-bottom: 1rem;

  border-bottom: 1px solid var(--border-color);

}



.task-details-title {

  font-size: 1.5rem;

  font-weight: 700;

  margin: 0;

  color: var(--text-primary);

  flex: 1;

}



.task-details-section {

  display: flex;

  flex-direction: column;

  gap: 0.75rem;

}



.section-title {

  font-size: 1rem;

  font-weight: 600;

  color: var(--text-primary);

  margin: 0;

}



.task-details-description {

  color: var(--text-secondary);

  line-height: 1.6;

  margin: 0;

  padding: 1rem;

  background: rgba(255, 255, 255, 0.02);

  border: 1px solid var(--border-color);

  border-radius: 8px;

}



.task-details-grid {

  display: grid;

  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));

  gap: 1rem;

}



.detail-item {

  display: flex;

  flex-direction: column;

  gap: 0.5rem;

  padding: 1rem;

  background: rgba(255, 255, 255, 0.02);

  border: 1px solid var(--border-color);

  border-radius: 8px;

}



.detail-label {

  font-size: 0.8rem;

  color: var(--text-tertiary);

  font-weight: 500;

  text-transform: uppercase;

  letter-spacing: 0.5px;

}



.detail-value {

  font-weight: 600;

  color: var(--text-primary);

  font-size: 1rem;

}



.detail-value.overdue {

  color: #ef4444;

}



.detail-role {

  font-size: 0.75rem;

  color: var(--text-secondary);

  background: rgba(255, 255, 255, 0.05);

  padding: 0.2rem 0.4rem;

  border-radius: 4px;

  margin-top: 0.25rem;

  display: inline-block;

}



.task-details-actions {

  display: flex;

  justify-content: flex-end;

  gap: 1rem;

  padding-top: 1rem;

  border-top: 1px solid var(--border-color);

}



.btn-danger {

  background: #ef4444;

  color: white;

  border: none;

  border-radius: 8px;

  padding: 0.75rem 1.5rem;

  font-size: 0.9rem;

  font-weight: 500;

  cursor: pointer;

  transition: all 0.2s ease;

  display: flex;

  align-items: center;

  gap: 0.5rem;

}



.btn-danger:hover {

  background: #dc2626;

  transform: translateY(-1px);

}



.btn-secondary {

  background: var(--bg-secondary);

  color: var(--text-primary);

  border: 1px solid var(--border-color);

  border-radius: 8px;

  padding: 0.75rem 1.5rem;

  font-size: 0.9rem;

  font-weight: 500;

  cursor: pointer;

  transition: all 0.2s ease;

}



.btn-secondary:hover {

  background: var(--border-hover);

  border-color: var(--border-hover);

}



/* Modal close button hover */

.modal-close:hover {

  background: var(--bg-secondary);

  color: var(--text-primary);

}



/* Responsive Design */
@media (max-width: 768px) {
  .task-cards {
    grid-template-columns: 1fr;
    padding: 1rem;
  overflow-x: hidden;

  }
  
  .task-footer {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .task-badges {
  width: 100%;

    justify-content: flex-start;
  }
  
  .task-deadline {
    align-self: flex-end;
  }
  

}

@media (max-width: 480px) {
  .task-cards {
    padding: 0.75rem;
    gap: 0.75rem;
  }
  
  .task-card {
    padding: 1rem;
  }
  
  .task-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
  
  .task-actions {
    align-self: flex-end;
  }
}



/* Status badge styles */

.status-overdue {

  background: rgba(239, 68, 68, 0.2);

  color: #fca5a5;

  border: 1px solid rgba(239, 68, 68, 0.3);

}



.status-pending {

  background: rgba(251, 191, 36, 0.2);

  color: #fbbf24;

}



.status-in_progress {

  background: rgba(59, 130, 246, 0.2);

  color: #93c5fd;

}



.status-completed {

  background: rgba(16, 185, 129, 0.2);

  color: #6ee7b7;

}



.status-cancelled {

  background: rgba(107, 114, 128, 0.2);

  color: #9ca3af;

}


/* Hide all scrollbars */
* {
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* Internet Explorer 10+ */
}

*::-webkit-scrollbar {
  display: none; /* WebKit */
}

/* Prevent horizontal scroll on body */
body {
  overflow-x: hidden;
}

/* Ensure no horizontal overflow on main containers */
.table-container {
  overflow-x: hidden;
  width: 100%;
  box-sizing: border-box;
}
</style>